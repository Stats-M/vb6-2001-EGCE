# vb6-2001-EGCE (elite-games conference extractor)
Rade (C) 2001 (MS Visual Basic 6) Learning project of my youth. Hail to spaghetti code and a lot of emotional comments!
Specialized old BBS-style web conference data extractor

This project was commited to one of the famous russian webcites dedicated to all space-related games - Elite Games (currently located at www.elite-games-.ru) It was (and is) the central place for fans of Elite, Privateer, EVE, X-series and other games in the genre of space simulators.

Back that time (2000-2001) this project was still a fan-cite, located at a free web-hosting, running a simple bulletin-board system. You can recall topics in threads of these BBs looked like a trees with indent. Somewhere at 2001 the cote finally has moved to a paid hosting and implements modern PHP forum script.

In order to preserve the fun and feel of the old forum, the happines of the good old days, Elite Game Conference Extractor (EGCE) project has been started.
The task were:
-download all text content
-rebuild all it in a manner of a modern PHP forum
-implement navigation system for all
-preserve old BBs tree-like thread index because indentation in BBs indicates to which post a user has publish a reply.

So EGCE does:
-download all BBs content
-generate forum pages, table of content and java scripts (sorting, indentation, etc.)
NB. In modern browser identations script works no more, keeping thread trees "flat"


Описание версий:
================

1.01.0033
=========
-Первая закачка заданной страницы целиком в автоматическом режиме.

1.01.0034
=========
-Исправлены некоторые ошибки Feeder'a (нарезка сообщений)
-Исправлены баги определения номера закачиваемой страницы
-Повтор запросов при ошибках загрузки страниц

1.01.0035
=========
-Подключена база данных по авторам.

1.01.0037
=========
-Закачанные страницы теперь содержат навигатор для облегчения перемещения

1.01.0038
=========
-Пофиксены некоторые баги в скрипте навигатора
-Ликвидирована причина появления пустых строк в итоговой странице сообщений

1.01.0039
=========
-Исправлен баг обновления журнала

1.01.0045
=========
-Журнал теперь обновляется и в случае останова закачки.
-Расширена справочная система.
-Пофиксен баг двойного вызова функции обновления журнала.
-Увеличено количество информационных сообщений.
-Сервер перешел на новый формат ссылок. Пока система адресации поправлена, но нужно будет сделать автоопределение адреса.
-Исправлена ошибка генератора ссылок.

1.01.0046
=========
-Снова  работает сервер book.by.ry, лежавший всю весну и начало лета. Опять поменялась система адресации. Опять исправлены нарезка ссылков, исправлена трактовка e-mail в качестве ссылок и много аналогичных правок.
-Система автоопределения адреса подключена. Надеюсь, теперь переделки будут небольшими, если  они вообще понадобятся.
-Опять вылезли баги записи HTML. Заголовок пишется мимо, шрифт сообщений переключается еще до вывода самих сообщений...

1.02.0047
=========
-Пофиксены баги заголовков, страница оформляется теперь нормально.
-Немного переделано оглавление.
-Зафиксирована ошибка при неверной индексации на сервере book.ru. На отрицательную длину даты программа ругается при записи заголовка сообщения.
-Исправлен алгоритм сортировки закачанных сообщений по номерам ссылок, но баг все еще остался.
-Исправлена функция очистки строки от лидирующих и закрывающих пробелов: функция работала корректно, но возвратить значение забывала :)
-Из заголовков теперь вырезается комбинация "(-)". Оказалось, это вызывает ложные срабатывания системы определения ошибок индексации. Надеюсь, ничего страшного не будет утеряно.

1.02.0048
=========
-Вырезание "(-)" теперь действительно работает, а не только проверка.
-Причина появления нулей при сортировке проста: все записи нулевые (неудивительно). Где-то неправильно обрабатывается дата сообщения, что должно быть одним из признаков корректной закачки.
-Переработан алгоритм сортировки и селективной записи журнала закачки. Теперь должно работать.

1.03.0049
=========
-Отловлен злобный баг с появлением нулей. Сразу все заработало... По крайней мере, база данных по авторам теперь сортируется ОК. 
-Продолжается доводка HTML-генератора страниц с текстами сообщений и оглавления.
-HTML-генератор страниц с сведениями об авторах теперь теоретически знает о возможности построения списка авторов по времени их первого появления в конфе.
-Проблемы с комбинацией "(+)", точно такие же, что и с "(-)" недавно. Придется вырезать.

1.03.0050
=========
-Перевод даты в цифровой формат работает с ошибкой. Исправлено.
-Исправлен баг с использованием неверного имени файла БД авторов.
-Добавлена сортировка авторов по времени первого появления в конфе.
-Исправлена ошибка, препятствовавшая удалению временных файлов.
-Исправлена ошибка в генераторе оглавления и стартовой страницы.
-Исправлена ошибка обработки БД по авторам.
-Подкорректирована работа HTML-генератора страниц со сведениями об авторах.
-Продолжаются проблемы с комбинацией "(-)", теперь ошибки вызывает появление двух "минусов" друг за другом. Пофиксено (надеюсь).
-Исправлена ошибка сортировки авторов по количеству и размеру сообщений.
-Изменен порядок сортировки авторов по количеству и размеру сообщений.

1.03.0051
=========
-Глобальный переход на использование CSS, уменьшение размера выходных файлов. Отладка HTML всех генераторов.
-Исправлены ошибки CSS.
-Подправлен текст программы для увеличения надежности.
-Серьезно изменен алгоритм записи файла журнала. Надеюсь, это уменьшит количество ошибок.
-Изменен алгоритм записи статистики в БД по авторам также по причине периодически возникающих сбоев.

1.03.0052
=========
-Исправлены небольшие баги сбора информации об авторах. Теперь все работает.
-Исправлена ошибка алгоритма обновления журнала.

1.03.0053
=========
-Исправлена ошибка, при которой в БД авторов не записывалась информация о размере и количестве сообщений.
-Если у автора указано больше одного почтового адреса, то они все автоматически добавляются в поле "Кому" при щелчке по ссылке.

1.03.0054
=========
-Улучшен дизайн страницы с сообщениями.
-Исправлены незначительные ошибки генератора оглавления, добавлена возможность поиска.

1.03.0055
=========
-При отправке почты автору сообщения, в поле "Тема" автоматически заносится небольшой заголовок.

1.03.0056
=========
-Изменена структура записи навигаторов страниц. Должно стать нагляднее.
-Исправлены ошибки генератора оглавления.

1.03.0057
=========
-Скрипт навигатора вынесен в отдельный файл.
-Исправлен текст оглавления.
-Исправлен текст навигатора.

1.03.0058
=========
-Исправлен скрипт навигатора. Теперь показывается правильный текст.
-Убраны лишние теги из текстов сообщений.
-Скрипт оглавления теперь производит поиск и в статистике по авторам.
-Скрипт навигатора теперь проверяет некоторые параметры на допустимость.

1.03.0059
=========
-После закачки последнего сообщения и входа в длительный цикл обновления журнала, программа больше не захватывает процессор в единоличное пользование, позволяя другим приложениям нормально функционировать.
-С помощью кнопки "Повтор" теперь можно принудительно инициировать повторную закачку текущего сообщения, т.к. иногда случаются "подвисания качалки", связанные с неполучением сигнала "загрузка документа завершена".

1.04.0060
=========
-Исправлен баг, препятствовавший указанию всех известных eMail адресов автора сообщения при записи HTML.
-Добавлено автоопределение номера следующей закачиваемой страницы.
-Скрипт оглавления теперь позволяет настраивать параметры поиска (учет регистра, слова целиком).
